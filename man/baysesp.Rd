% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/baysesp.R
\name{baysesp}
\alias{baysesp}
\title{Bayesian Estimation of Sensitivity and Specificity with Verification Bias}
\usage{
baysesp(
  stan_data,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  cores = getOption("mc.cores", 1L),
  priors = list(p = "beta(1, 1)", se = "beta(1, 1)", sp = "beta(1, 1)", l11 =
    "beta(1, 1)", l21 = "beta(1, 1)", l12 = "beta(1, 1)", l22 = "beta(1, 1)"),
  ...
)
}
\arguments{
\item{stan_data}{Named list. The data to be passed to Stan, typically generated
using \code{\link{data_frame_to_stan_data}} or \code{\link{y_to_stan_data}}.
It must contain the following named elements:
\describe{
\item{\code{s1}}{Number of verified true positives (\eqn{V = 1, T = 1, D = 1}).}
\item{\code{s2}}{Number of verified false negatives (\eqn{V = 1, T = 0, D = 1}).}
\item{\code{r1}}{Number of verified false positives (\eqn{V = 1, T = 1, D = 0}).}
\item{\code{r2}}{Number of verified true negatives (\eqn{V = 1, T = 0, D = 0}).}
\item{\code{u1}}{Number of unverified individuals who tested positive (\eqn{V = 0, T = 1, D = NA}).}
\item{\code{u2}}{Number of unverified individuals who tested negative (\eqn{V = 0, T = 0, D = NA}).}
}}

\item{chains}{Integer. Number of Markov chains to run in the Stan model. Default is 4.}

\item{iter}{Integer. Total number of iterations per chain. Default is 2000.}

\item{warmup}{Integer. Number of warmup (burn-in) iterations per chain. Default is \code{iter / 2}.}

\item{cores}{Integer. Number of CPU cores to use for parallel computation. Defaults to \code{getOption("mc.cores", 1L)}.}

\item{priors}{Named list. A list specifying the prior distributions for each parameter.
The list must include the following named elements:
\describe{
\item{\code{"p"}}{Prior for disease prevalence (\eqn{p}), e.g., \code{"beta(1,1)"}.}
\item{\code{"se"}}{Prior for sensitivity (\eqn{Se = P(T = 1 | D = 1)}), e.g., \code{"beta(1,1)"}.}
\item{\code{"sp"}}{Prior for specificity (\eqn{Sp = P(T = 0 | D = 0)}), e.g., \code{"beta(1,1)"}.}
\item{\code{"l11"}}{Prior for verification probability given \eqn{(T = 1, D = 1)} (\eqn{P(V = 1 | T = 1, D = 1)}).}
\item{\code{"l21"}}{Prior for verification probability given \eqn{(T = 1, D = 0)} (\eqn{P(V = 1 | T = 1, D = 0)}).}
\item{\code{"l12"}}{Prior for verification probability given \eqn{(T = 0, D = 1)} (\eqn{P(V = 1 | T = 0, D = 1)}).}
\item{\code{"l22"}}{Prior for verification probability given \eqn{(T = 0, D = 0)} (\eqn{P(V = 1 | T = 0, D = 0)}).}
}
Each prior should be specified using Stan's syntax (e.g., \code{"beta(1,1)"} or \code{"normal(0.5,0.1)"}).}

\item{...}{Additional arguments to pass to the \code{\link[rstan]{stan}} function.}
}
\value{
A \code{\link[rstan]{stanfit}} object containing the posterior samples
and summary statistics from the Bayesian estimation.
}
\description{
This function estimates the sensitivity and specificity of a diagnostic test
in the presence of verification bias using a Bayesian approach implemented in Stan.
It constructs a Stan model based on user-specified priors, compiles and runs the model,
and returns the fitted Stan object.
}
\examples{
# Generate example data
set.seed(123)
y <- baysesp_simul(n = 500, nsim = 1)
stan_data <- y_to_stan_data(y)

# Run Bayesian estimation with default priors
\dontrun{
fit <- baysesp(stan_data)
print(fit)
}
}
